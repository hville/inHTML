<!DOCTYPE html>
<head></head>

<script type=module>
	import {frame} from './browser.js'
	const plain = frame(`x=>x+2`),
				closure = frame(`x=>x+y`, `const y=2`),
				global = frame(`x=>x+y`, `window.y=2`),
				this_ = frame(`function(x) { return x+this.y }`, `window.y=2`),
				dom = frame(`x => +document.body.textContent+x`, `onload = () => document.body.textContent=2`),
				batshit = frame(`async x => (await ff)(x)`, `import {frame} from './in-frame.js';
				const ff = frame('x=>x+2')`)

	async function test(msg,f,arg) {
		//f.catch(e => console.log('!',e))
		document.body.append(msg, await f(arg))
	}

	test('plain', await plain, 1)
	test('closure', await closure, 1)
	test('global', await global, 1)
	test('this_', await this_, 1)
	test('dom', await dom, 1)
	test('batshit', await batshit, 1)
</script>
</html>
